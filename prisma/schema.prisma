generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                    String   @id @default(uuid())
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
  email                 String   @unique
  password              String?
  firstName             String?
  lastName              String?
  age                   Int?
  profileImage          String?
  smoker                Boolean?
  pets                  Boolean?
  budgetMax             Int?
  propertyId            String?
  emailVerificationCode String   @unique
  emailVerified         Boolean  @default(true)
  profileVisible        Boolean  @default(false)
  provider              String?
  providerAccountId     String?
  passwordResetCode     String?  @unique
  bgImage               String?
  description           String?
  gender                String?
  moodboardImages       String[]
  phone                 String?
  city                  String?
  districts             String[]
  searchAmount          String?

  // Relations
  messagesReceived Message[]  @relation("MessagesReceived")
  messagesSent     Message[]  @relation("MessagesSent")
  properties       Property[]
  reviewsWritten   Review[]   @relation("ReviewsWritten")
  reviewsReceived  Review[]   @relation("ReviewsReceived")

  interests          Interest[]
  occupation         Occupation[]
  searchPreferences  SearchPreference[]
  searchPropertyType PropertyOption[]

  noiseCompatibility NoiseCompatibility[]
  petsCompatibility  PetsCompatibility[]

  roommateInProperties Property[] @relation("PropertyRoommates")
}

model Property {
  id              String         @id @default(uuid())
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  type            PropertyType
  status          PropertyStatus @default(ACTIVE)
  title           String
  description     String?
  price           Int
  currency        String
  deposit         Int?
  utilities       Int?
  city            String
  district        String?
  street          String?
  postalCode      String?
  latitude        Float?
  longitude       Float?
  sizeM2          Int?
  rooms           Int?
  bathrooms       Int?
  floor           Int?
  yearBuilt       Int?
  furnished       Boolean?
  condition       String?
  balcony         Boolean?
  elevator        Boolean?
  parking         Boolean?
  petsAllowed     Boolean?
  smokingAllowed  Boolean?
  internet        Boolean?
  washingMachine  Boolean?
  dishwasher      Boolean?
  airConditioning Boolean?
  isShared        Boolean?       @default(false)
  roomType        String?
  images          String[]
  videoUrl        String?
  floorPlanUrl    String?
  ownerId         String
  owner           User           @relation(fields: [ownerId], references: [id])
  roommates       User[]         @relation("PropertyRoommates")
}

model Review {
  id          String   @id @default(uuid())
  createdAt   DateTime @default(now())
  rating      Int
  comment     String?
  authorId    String
  recipientId String
  author      User     @relation("ReviewsWritten", fields: [authorId], references: [id])
  recipient   User     @relation("ReviewsReceived", fields: [recipientId], references: [id])
}

model Message {
  id         String   @id @default(uuid())
  createdAt  DateTime @default(now())
  content    String
  senderId   String
  receiverId String
  receiver   User     @relation("MessagesReceived", fields: [receiverId], references: [id])
  sender     User     @relation("MessagesSent", fields: [senderId], references: [id])
}

model Interest {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model Occupation {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model SearchPreference {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model PropertyOption {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model NoiseCompatibility {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model PetsCompatibility {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

enum PropertyType {
  RENT
  SALE
  FLATSHARE
}

enum PropertyStatus {
  ACTIVE
  RESERVED
  RENTED
  SOLD
}
