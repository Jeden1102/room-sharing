generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                    String   @id @default(uuid())
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
  email                 String   @unique
  password              String?
  firstName             String?
  lastName              String?
  age                   Int?
  profileImage          String?
  smoker                Boolean?
  pets                  Boolean?
  budgetMax             Int?
  propertyId            String?
  emailVerificationCode String   @unique
  emailVerified         Boolean  @default(true)
  profileVisible        Boolean  @default(false)
  provider              String?
  providerAccountId     String?
  passwordResetCode     String?  @unique
  bgImage               String?
  description           String?
  gender                String?
  moodboardImages       String[]
  phone                 String?
  city                  String?
  districts             String[]
  searchAmount          String?

  // Relations
  messagesReceived Message[]  @relation("MessagesReceived")
  messagesSent     Message[]  @relation("MessagesSent")
  properties       Property[]

  interests          Interest[]
  occupation         Occupation[]
  searchPreferences  SearchPreference[]
  searchPropertyType PropertyOption[]

  noiseCompatibility NoiseCompatibility[]
  petsCompatibility  PetsCompatibility[]

  roommateInProperties Property[] @relation("PropertyRoommates")
}

model Property {
  id              String         @id @default(uuid())
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  type            String?
  listingType     ListingType
  status          PropertyStatus @default(DRAFT)
  title           String
  description     String?
  price           Int
  deposit         Int?
  city            String
  district        String?
  street          String?
  buildingNumber  String?
  latitude        Float? //todo
  longitude       Float? // todo
  sizeM2          Int?
  rooms           Int?
  floor           Int?
  yearBuilt       Int?
  furnished       Boolean?
  balcony         Boolean?
  elevator        Boolean?
  parking         Boolean?
  petsAllowed     Boolean?
  smokingAllowed  Boolean?
  internet        Boolean?
  tv              Boolean?
  washingMachine  Boolean?
  dishwasher      Boolean?
  airConditioning Boolean?
  isShared        Boolean?       @default(false) // @todo
  roomType        String?
  images          String[]
  ownerId         String
  email           String?
  phone           String?
  owner           User           @relation(fields: [ownerId], references: [id])
  roommates       User[]         @relation("PropertyRoommates")
}

model Message {
  id         String   @id @default(uuid())
  createdAt  DateTime @default(now())
  content    String
  senderId   String
  receiverId String
  receiver   User     @relation("MessagesReceived", fields: [receiverId], references: [id])
  sender     User     @relation("MessagesSent", fields: [senderId], references: [id])
}

model Interest {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model Occupation {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model SearchPreference {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model PropertyOption {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model NoiseCompatibility {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

model PetsCompatibility {
  id    String @id @default(uuid())
  name  String @unique
  users User[]
}

enum PropertyStatus {
  DRAFT
  ACTIVE
  RESERVED
}

enum ListingType {
  SALE
  RENT
}
